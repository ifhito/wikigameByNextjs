# ゲームロジック

## 概要
ゲームの主要なロジックとルールについて説明します。

## ゲームモード

### 1. マルチプレイヤーモード
#### 対戦モード（competitive）
- 各プレイヤーに異なるゴールページが割り当てられる
- 他のプレイヤーのゴールページを避けながら進む
- 最初にゴールに到達したプレイヤーが勝利

#### 協力モード（cooperative）
- 全プレイヤーが同じゴールページを目指す
- 協力して最短ルートを見つける
- 全員がゴールに到達すると勝利

### 2. ソロモード
- 6回までのリンククリックが可能
- 6回目のリンクでゴールに到達すると勝利
- 6回以内にゴールに到達すると敗北

## ゲーム進行

### 1. 初期化
- ランダムな開始ページを選択
- ゴールページの割り当て
- プレイヤーの準備状態の確認

### 2. ターン進行
- プレイヤーの順番を管理
- クリック可能なリンクの制御
- 移動履歴の記録

### 3. ゴール判定
- ページタイトルの正規化
- ゴール条件のチェック
- 勝敗の判定

## データ構造

### 1. ゲーム状態
```typescript
interface GameState {
  currentPage: string;
  players: Player[];
  currentPlayerIndex: number;
  turnCount: number;
  gameStatus: 'waiting' | 'playing' | 'finished';
  history: Move[];
}
```

### 2. 移動履歴
```typescript
interface Move {
  playerId: string;
  fromPage: string;
  toPage: string;
  turnNumber: number;
}
```

## 特殊ルール

### 1. ページ制限
- 同じページへの再訪問制限
- 特定のページへのアクセス制限

### 2. ターン制限
- 最大ターン数の設定
- ターン切れ時の処理

### 3. ゴール条件
- 完全一致
- 部分一致
- リダイレクトの考慮

## エラー処理
- 無効な移動の検出
- 接続切断時の処理
- タイムアウト処理

## 最適化
- キャッシュの活用
- 並行処理の制御
- メモリ使用量の最適化 